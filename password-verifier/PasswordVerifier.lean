-- THIS FILE WAS AUTOMATICALLY GENERATED BY AENEAS
-- [password_verifier]
import Aeneas
open Aeneas.Std Result Error
set_option linter.dupNamespace false
set_option linter.hashCommand false
set_option linter.unusedVariables false
set_option maxRecDepth 1024

namespace password_verifier

/- [password_verifier::constant_time::ct_eq_bytes]:
   Source: 'src/constant_time.rs', lines 17:0-31:1 -/
def constant_time.ct_eq_bytes
  (a : Array U8 8#usize) (b : Array U8 8#usize) : Result Bool := do
  let i ← Array.index_usize a 0#usize
  let i1 ← Array.index_usize b 0#usize
  let i2 ← (↑(i ^^^ i1) : Result U8)
  let acc ← (↑(0#u8 ||| i2) : Result U8)
  let i3 ← Array.index_usize a 1#usize
  let i4 ← Array.index_usize b 1#usize
  let i5 ← (↑(i3 ^^^ i4) : Result U8)
  let acc1 ← (↑(acc ||| i5) : Result U8)
  let i6 ← Array.index_usize a 2#usize
  let i7 ← Array.index_usize b 2#usize
  let i8 ← (↑(i6 ^^^ i7) : Result U8)
  let acc2 ← (↑(acc1 ||| i8) : Result U8)
  let i9 ← Array.index_usize a 3#usize
  let i10 ← Array.index_usize b 3#usize
  let i11 ← (↑(i9 ^^^ i10) : Result U8)
  let acc3 ← (↑(acc2 ||| i11) : Result U8)
  let i12 ← Array.index_usize a 4#usize
  let i13 ← Array.index_usize b 4#usize
  let i14 ← (↑(i12 ^^^ i13) : Result U8)
  let acc4 ← (↑(acc3 ||| i14) : Result U8)
  let i15 ← Array.index_usize a 5#usize
  let i16 ← Array.index_usize b 5#usize
  let i17 ← (↑(i15 ^^^ i16) : Result U8)
  let acc5 ← (↑(acc4 ||| i17) : Result U8)
  let i18 ← Array.index_usize a 6#usize
  let i19 ← Array.index_usize b 6#usize
  let i20 ← (↑(i18 ^^^ i19) : Result U8)
  let acc6 ← (↑(acc5 ||| i20) : Result U8)
  let i21 ← Array.index_usize a 7#usize
  let i22 ← Array.index_usize b 7#usize
  let i23 ← (↑(i21 ^^^ i22) : Result U8)
  let acc7 ← (↑(acc6 ||| i23) : Result U8)
  ok (acc7 = 0#u8)

/- [password_verifier::constant_time::ct_eq_16]:
   Source: 'src/constant_time.rs', lines 34:0-55:1 -/
def constant_time.ct_eq_16
  (a : Array U8 16#usize) (b : Array U8 16#usize) : Result Bool := do
  let i ← Array.index_usize a 0#usize
  let i1 ← Array.index_usize b 0#usize
  let i2 ← (↑(i ^^^ i1) : Result U8)
  let acc ← (↑(0#u8 ||| i2) : Result U8)
  let i3 ← Array.index_usize a 1#usize
  let i4 ← Array.index_usize b 1#usize
  let i5 ← (↑(i3 ^^^ i4) : Result U8)
  let acc1 ← (↑(acc ||| i5) : Result U8)
  let i6 ← Array.index_usize a 2#usize
  let i7 ← Array.index_usize b 2#usize
  let i8 ← (↑(i6 ^^^ i7) : Result U8)
  let acc2 ← (↑(acc1 ||| i8) : Result U8)
  let i9 ← Array.index_usize a 3#usize
  let i10 ← Array.index_usize b 3#usize
  let i11 ← (↑(i9 ^^^ i10) : Result U8)
  let acc3 ← (↑(acc2 ||| i11) : Result U8)
  let i12 ← Array.index_usize a 4#usize
  let i13 ← Array.index_usize b 4#usize
  let i14 ← (↑(i12 ^^^ i13) : Result U8)
  let acc4 ← (↑(acc3 ||| i14) : Result U8)
  let i15 ← Array.index_usize a 5#usize
  let i16 ← Array.index_usize b 5#usize
  let i17 ← (↑(i15 ^^^ i16) : Result U8)
  let acc5 ← (↑(acc4 ||| i17) : Result U8)
  let i18 ← Array.index_usize a 6#usize
  let i19 ← Array.index_usize b 6#usize
  let i20 ← (↑(i18 ^^^ i19) : Result U8)
  let acc6 ← (↑(acc5 ||| i20) : Result U8)
  let i21 ← Array.index_usize a 7#usize
  let i22 ← Array.index_usize b 7#usize
  let i23 ← (↑(i21 ^^^ i22) : Result U8)
  let acc7 ← (↑(acc6 ||| i23) : Result U8)
  let i24 ← Array.index_usize a 8#usize
  let i25 ← Array.index_usize b 8#usize
  let i26 ← (↑(i24 ^^^ i25) : Result U8)
  let acc8 ← (↑(acc7 ||| i26) : Result U8)
  let i27 ← Array.index_usize a 9#usize
  let i28 ← Array.index_usize b 9#usize
  let i29 ← (↑(i27 ^^^ i28) : Result U8)
  let acc9 ← (↑(acc8 ||| i29) : Result U8)
  let i30 ← Array.index_usize a 10#usize
  let i31 ← Array.index_usize b 10#usize
  let i32 ← (↑(i30 ^^^ i31) : Result U8)
  let acc10 ← (↑(acc9 ||| i32) : Result U8)
  let i33 ← Array.index_usize a 11#usize
  let i34 ← Array.index_usize b 11#usize
  let i35 ← (↑(i33 ^^^ i34) : Result U8)
  let acc11 ← (↑(acc10 ||| i35) : Result U8)
  let i36 ← Array.index_usize a 12#usize
  let i37 ← Array.index_usize b 12#usize
  let i38 ← (↑(i36 ^^^ i37) : Result U8)
  let acc12 ← (↑(acc11 ||| i38) : Result U8)
  let i39 ← Array.index_usize a 13#usize
  let i40 ← Array.index_usize b 13#usize
  let i41 ← (↑(i39 ^^^ i40) : Result U8)
  let acc13 ← (↑(acc12 ||| i41) : Result U8)
  let i42 ← Array.index_usize a 14#usize
  let i43 ← Array.index_usize b 14#usize
  let i44 ← (↑(i42 ^^^ i43) : Result U8)
  let acc14 ← (↑(acc13 ||| i44) : Result U8)
  let i45 ← Array.index_usize a 15#usize
  let i46 ← Array.index_usize b 15#usize
  let i47 ← (↑(i45 ^^^ i46) : Result U8)
  let acc15 ← (↑(acc14 ||| i47) : Result U8)
  ok (acc15 = 0#u8)

/- [password_verifier::constant_time::ct_eq_32]:
   Source: 'src/constant_time.rs', lines 58:0-98:1 -/
def constant_time.ct_eq_32
  (a : Array U8 32#usize) (b : Array U8 32#usize) : Result Bool := do
  let i ← Array.index_usize a 0#usize
  let i1 ← Array.index_usize b 0#usize
  let i2 ← (↑(i ^^^ i1) : Result U8)
  let acc ← (↑(0#u8 ||| i2) : Result U8)
  let i3 ← Array.index_usize a 1#usize
  let i4 ← Array.index_usize b 1#usize
  let i5 ← (↑(i3 ^^^ i4) : Result U8)
  let acc1 ← (↑(acc ||| i5) : Result U8)
  let i6 ← Array.index_usize a 2#usize
  let i7 ← Array.index_usize b 2#usize
  let i8 ← (↑(i6 ^^^ i7) : Result U8)
  let acc2 ← (↑(acc1 ||| i8) : Result U8)
  let i9 ← Array.index_usize a 3#usize
  let i10 ← Array.index_usize b 3#usize
  let i11 ← (↑(i9 ^^^ i10) : Result U8)
  let acc3 ← (↑(acc2 ||| i11) : Result U8)
  let i12 ← Array.index_usize a 4#usize
  let i13 ← Array.index_usize b 4#usize
  let i14 ← (↑(i12 ^^^ i13) : Result U8)
  let acc4 ← (↑(acc3 ||| i14) : Result U8)
  let i15 ← Array.index_usize a 5#usize
  let i16 ← Array.index_usize b 5#usize
  let i17 ← (↑(i15 ^^^ i16) : Result U8)
  let acc5 ← (↑(acc4 ||| i17) : Result U8)
  let i18 ← Array.index_usize a 6#usize
  let i19 ← Array.index_usize b 6#usize
  let i20 ← (↑(i18 ^^^ i19) : Result U8)
  let acc6 ← (↑(acc5 ||| i20) : Result U8)
  let i21 ← Array.index_usize a 7#usize
  let i22 ← Array.index_usize b 7#usize
  let i23 ← (↑(i21 ^^^ i22) : Result U8)
  let acc7 ← (↑(acc6 ||| i23) : Result U8)
  let i24 ← Array.index_usize a 8#usize
  let i25 ← Array.index_usize b 8#usize
  let i26 ← (↑(i24 ^^^ i25) : Result U8)
  let acc8 ← (↑(acc7 ||| i26) : Result U8)
  let i27 ← Array.index_usize a 9#usize
  let i28 ← Array.index_usize b 9#usize
  let i29 ← (↑(i27 ^^^ i28) : Result U8)
  let acc9 ← (↑(acc8 ||| i29) : Result U8)
  let i30 ← Array.index_usize a 10#usize
  let i31 ← Array.index_usize b 10#usize
  let i32 ← (↑(i30 ^^^ i31) : Result U8)
  let acc10 ← (↑(acc9 ||| i32) : Result U8)
  let i33 ← Array.index_usize a 11#usize
  let i34 ← Array.index_usize b 11#usize
  let i35 ← (↑(i33 ^^^ i34) : Result U8)
  let acc11 ← (↑(acc10 ||| i35) : Result U8)
  let i36 ← Array.index_usize a 12#usize
  let i37 ← Array.index_usize b 12#usize
  let i38 ← (↑(i36 ^^^ i37) : Result U8)
  let acc12 ← (↑(acc11 ||| i38) : Result U8)
  let i39 ← Array.index_usize a 13#usize
  let i40 ← Array.index_usize b 13#usize
  let i41 ← (↑(i39 ^^^ i40) : Result U8)
  let acc13 ← (↑(acc12 ||| i41) : Result U8)
  let i42 ← Array.index_usize a 14#usize
  let i43 ← Array.index_usize b 14#usize
  let i44 ← (↑(i42 ^^^ i43) : Result U8)
  let acc14 ← (↑(acc13 ||| i44) : Result U8)
  let i45 ← Array.index_usize a 15#usize
  let i46 ← Array.index_usize b 15#usize
  let i47 ← (↑(i45 ^^^ i46) : Result U8)
  let acc15 ← (↑(acc14 ||| i47) : Result U8)
  let i48 ← Array.index_usize a 16#usize
  let i49 ← Array.index_usize b 16#usize
  let i50 ← (↑(i48 ^^^ i49) : Result U8)
  let acc16 ← (↑(acc15 ||| i50) : Result U8)
  let i51 ← Array.index_usize a 17#usize
  let i52 ← Array.index_usize b 17#usize
  let i53 ← (↑(i51 ^^^ i52) : Result U8)
  let acc17 ← (↑(acc16 ||| i53) : Result U8)
  let i54 ← Array.index_usize a 18#usize
  let i55 ← Array.index_usize b 18#usize
  let i56 ← (↑(i54 ^^^ i55) : Result U8)
  let acc18 ← (↑(acc17 ||| i56) : Result U8)
  let i57 ← Array.index_usize a 19#usize
  let i58 ← Array.index_usize b 19#usize
  let i59 ← (↑(i57 ^^^ i58) : Result U8)
  let acc19 ← (↑(acc18 ||| i59) : Result U8)
  let i60 ← Array.index_usize a 20#usize
  let i61 ← Array.index_usize b 20#usize
  let i62 ← (↑(i60 ^^^ i61) : Result U8)
  let acc20 ← (↑(acc19 ||| i62) : Result U8)
  let i63 ← Array.index_usize a 21#usize
  let i64 ← Array.index_usize b 21#usize
  let i65 ← (↑(i63 ^^^ i64) : Result U8)
  let acc21 ← (↑(acc20 ||| i65) : Result U8)
  let i66 ← Array.index_usize a 22#usize
  let i67 ← Array.index_usize b 22#usize
  let i68 ← (↑(i66 ^^^ i67) : Result U8)
  let acc22 ← (↑(acc21 ||| i68) : Result U8)
  let i69 ← Array.index_usize a 23#usize
  let i70 ← Array.index_usize b 23#usize
  let i71 ← (↑(i69 ^^^ i70) : Result U8)
  let acc23 ← (↑(acc22 ||| i71) : Result U8)
  let i72 ← Array.index_usize a 24#usize
  let i73 ← Array.index_usize b 24#usize
  let i74 ← (↑(i72 ^^^ i73) : Result U8)
  let acc24 ← (↑(acc23 ||| i74) : Result U8)
  let i75 ← Array.index_usize a 25#usize
  let i76 ← Array.index_usize b 25#usize
  let i77 ← (↑(i75 ^^^ i76) : Result U8)
  let acc25 ← (↑(acc24 ||| i77) : Result U8)
  let i78 ← Array.index_usize a 26#usize
  let i79 ← Array.index_usize b 26#usize
  let i80 ← (↑(i78 ^^^ i79) : Result U8)
  let acc26 ← (↑(acc25 ||| i80) : Result U8)
  let i81 ← Array.index_usize a 27#usize
  let i82 ← Array.index_usize b 27#usize
  let i83 ← (↑(i81 ^^^ i82) : Result U8)
  let acc27 ← (↑(acc26 ||| i83) : Result U8)
  let i84 ← Array.index_usize a 28#usize
  let i85 ← Array.index_usize b 28#usize
  let i86 ← (↑(i84 ^^^ i85) : Result U8)
  let acc28 ← (↑(acc27 ||| i86) : Result U8)
  let i87 ← Array.index_usize a 29#usize
  let i88 ← Array.index_usize b 29#usize
  let i89 ← (↑(i87 ^^^ i88) : Result U8)
  let acc29 ← (↑(acc28 ||| i89) : Result U8)
  let i90 ← Array.index_usize a 30#usize
  let i91 ← Array.index_usize b 30#usize
  let i92 ← (↑(i90 ^^^ i91) : Result U8)
  let acc30 ← (↑(acc29 ||| i92) : Result U8)
  let i93 ← Array.index_usize a 31#usize
  let i94 ← Array.index_usize b 31#usize
  let i95 ← (↑(i93 ^^^ i94) : Result U8)
  let acc31 ← (↑(acc30 ||| i95) : Result U8)
  ok (acc31 = 0#u8)

/- [password_verifier::constant_time::xor_byte]:
   Source: 'src/constant_time.rs', lines 101:0-103:1 -/
def constant_time.xor_byte (a : U8) (b : U8) : Result U8 := do
  ok (a ^^^ b)

/- [password_verifier::constant_time::or_byte]:
   Source: 'src/constant_time.rs', lines 106:0-108:1 -/
def constant_time.or_byte (a : U8) (b : U8) : Result U8 := do
  ok (a ||| b)

/- [password_verifier::constant_time::is_zero]:
   Source: 'src/constant_time.rs', lines 111:0-113:1 -/
def constant_time.is_zero (x : U8) : Result Bool := do
  ok (x = 0#u8)

/- [password_verifier::password::SECRET]
   Source: 'src/password.rs', lines 16:0-16:66 -/
@[global_simps]
def password.SECRET_body : Result (Array U8 8#usize) := do
  ok
    (Array.make 8#usize [
      84#u8, 104#u8, 101#u8, 32#u8, 107#u8, 101#u8, 121#u8, 33#u8
      ])
@[global_simps, irreducible]
def password.SECRET : Array U8 8#usize := eval_global password.SECRET_body

/- [password_verifier::password::PASSWORD]
   Source: 'src/password.rs', lines 21:0-21:69 -/
@[global_simps]
def password.PASSWORD_body : Result (Array U8 8#usize) := do
  ok
    (Array.make 8#usize [
      104#u8, 117#u8, 110#u8, 116#u8, 101#u8, 114#u8, 52#u8, 50#u8
      ])
@[global_simps, irreducible]
def password.PASSWORD : Array U8 8#usize := eval_global password.PASSWORD_body

/- [password_verifier::password::check_password]:
   Source: 'src/password.rs', lines 25:0-27:1 -/
def password.check_password (input : Array U8 8#usize) : Result Bool := do
  constant_time.ct_eq_bytes input password.PASSWORD

/- [password_verifier::password::reveal_secret]:
   Source: 'src/password.rs', lines 35:0-41:1 -/
def password.reveal_secret
  (input : Array U8 8#usize) : Result (Option (Array U8 8#usize)) := do
  let b ← password.check_password input
  if b
  then ok (some password.SECRET)
  else ok none

/- [password_verifier::password::reveal_secret_result]:
   Source: 'src/password.rs', lines 45:0-51:1 -/
def password.reveal_secret_result
  (input : Array U8 8#usize) :
  Result (core.result.Result (Array U8 8#usize) Unit)
  := do
  let b ← password.check_password input
  if b
  then ok (core.result.Result.Ok password.SECRET)
  else ok (core.result.Result.Err ())

/- [password_verifier::password::get_secret]:
   Source: 'src/password.rs', lines 54:0-56:1 -/
def password.get_secret : Result (Array U8 8#usize) := do
  ok password.SECRET

/- [password_verifier::password::get_password]:
   Source: 'src/password.rs', lines 59:0-61:1 -/
def password.get_password : Result (Array U8 8#usize) := do
  ok password.PASSWORD

end password_verifier
